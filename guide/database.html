<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Database</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.a932b7f9.css" as="style"><link rel="preload" href="/assets/js/app.dbf517cc.js" as="script"><link rel="preload" href="/assets/js/6.9c954eb2.js" as="script"><link rel="prefetch" href="/assets/js/10.3bf30667.js"><link rel="prefetch" href="/assets/js/11.99124b77.js"><link rel="prefetch" href="/assets/js/12.17966d0d.js"><link rel="prefetch" href="/assets/js/13.910fc333.js"><link rel="prefetch" href="/assets/js/14.05138ba5.js"><link rel="prefetch" href="/assets/js/15.dae928df.js"><link rel="prefetch" href="/assets/js/2.f89b6ce7.js"><link rel="prefetch" href="/assets/js/3.e8d0c2e6.js"><link rel="prefetch" href="/assets/js/4.7b6b06e8.js"><link rel="prefetch" href="/assets/js/5.1c0b5f96.js"><link rel="prefetch" href="/assets/js/7.905288c6.js"><link rel="prefetch" href="/assets/js/8.0d11173f.js"><link rel="prefetch" href="/assets/js/9.49974597.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a932b7f9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <!----> </div> <div class="page"> <div class="content"><h1 id="database"><a href="#database" aria-hidden="true" class="header-anchor">#</a> Database</h1> <h2 id="table-of-contents"><a href="#table-of-contents" aria-hidden="true" class="header-anchor">#</a> Table of Contents</h2> <p></p><div class="table-of-contents"><ul><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#rule-of-thumb">Rule Of Thumb</a></li><li><a href="#database-server-requirement">Database Server Requirement</a></li><li><a href="#monitoring-alert">Monitoring &amp; Alert</a></li><li><a href="#reference">Reference</a></li></ul></div><p></p> <h2 id="rule-of-thumb"><a href="#rule-of-thumb" aria-hidden="true" class="header-anchor">#</a> Rule Of Thumb</h2> <ul><li>This is rule in our environment database</li> <li>Data type for primary key as id must integer.</li> <li>Data type for join table must integer.</li> <li>Do not join different DB.</li> <li>Use standards charset <strong>utf8</strong> and <strong>collation utf8_general_ci</strong>.</li> <li>Avoid <strong>SELECT * FROM ...</strong> in query apps. Please define your column.</li> <li>Handle possible null value in your app. Reference for Golang: <a href="https://medium.com/aubergine-solutions/how-i-handled-null-possible-values-from-database-rows-in-golang-521fb0ee267" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Avoid function <strong>now()</strong> and <strong>CURRENT_TIMESTAMP()</strong> in query db, generate date from app. Cause this function is costly.</li> <li>Do not add column with AFTER column. Because is not backward compatible.
<ul><li><strong>Wrong</strong> :</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> v2_videos<span class="token punctuation">.</span>video <span class="token keyword">ADD</span> subtitle_url  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">AFTER</span> subtitle_language<span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>Correct</strong> :</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> v2_videos<span class="token punctuation">.</span>video <span class="token keyword">ADD</span> subtitle_url  <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre></div></li> <li>Consult with dba if you want to create index or get data from huge table.</li></ul> <h2 id="database-server-requirement"><a href="#database-server-requirement" aria-hidden="true" class="header-anchor">#</a> Database Server Requirement</h2> <table><thead><tr><th>Name</th> <th>Value</th></tr></thead> <tbody><tr><td>DB Type</td> <td>Clustering (Active - Active nodes)</td></tr> <tr><td>RDBMS</td> <td>MariabDB-Galera 10.3.10</td></tr> <tr><td>Server Type</td> <td>VM</td></tr> <tr><td>OS</td> <td>Ubuntu 16 64bit</td></tr> <tr><td>Qty node</td> <td>3 (SG - BEL)</td></tr> <tr><td>Memory</td> <td>4G</td></tr> <tr><td>Disk</td> <td>20G</td></tr></tbody></table> <h2 id="monitoring-alert"><a href="#monitoring-alert" aria-hidden="true" class="header-anchor">#</a> Monitoring &amp; Alert</h2> <p>We have dashboard for monitoring all activity database server. This link for access grafana db dashboard
<a href="http://db.sstv.io" target="_blank" rel="noopener noreferrer">db.sstv.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Please access using vpn. if you don't have access please contact @infra.
Join our alert slack channel in #db-alerts-sstv</p> <h2 id="reference"><a href="#reference" aria-hidden="true" class="header-anchor">#</a> Reference</h2> <ul><li><a href="https://www.percona.com/blog/" target="_blank" rel="noopener noreferrer">Percona Performance<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://mariadb.com/kb/en/" target="_blank" rel="noopener noreferrer">Mariadb Knowledge Base<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.dbf517cc.js" defer></script><script src="/assets/js/6.9c954eb2.js" defer></script>
  </body>
</html>
